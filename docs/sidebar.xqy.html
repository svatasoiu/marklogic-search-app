<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xml:space="preserve"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>xqDoc -- Module</title><script language="JavaScript"><!--
        function popUp(URL) {
                 day = new Date();
                 id = day.getTime();
                 eval("page = window.open(URL, 'xqdoccode', 'toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=600,height=400,left = 412,top = 334');")
                 page.focus();
        }
      --></script><script language="JavaScript"><!--
	    function litePopUp(str) {    
  		  OpenWindow=window.open('', 'xqdoccode', 'toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=600,height=400,left = 412,top = 334');
  		  OpenWindow.document.write('<html xmlspace="preserve">');
  		  OpenWindow.document.write('<head>');
  		  OpenWindow.document.write('<title>xqDoc - Code Sample</title>');
  		  OpenWindow.document.write('</head>');  		    		    		  
  		  OpenWindow.document.write('<body xml:space="preserve">');
  		  OpenWindow.document.write('<pre>');
 		  OpenWindow.document.write(str);
 		  OpenWindow.document.write('</pre>');
  		  OpenWindow.document.write('</body>');
  		  OpenWindow.document.write('</html>');
  		  OpenWindow.document.close();
  		  page.focus();
        }
      --></script><style><!--
body		{
		font: 80% Verdana;
		}
table		{
		font-size: 100%;
		}
h1, h2, h3, h4, h5, h6
		{
		clear: both;
		float: none;
		}
h1		{
		font-size: 100%;
		margin: 0em;
		}
h2		{
		font-size: 180%;
		margin-bottom: -1em;
		margin-top: .3em;
		}
h3		{
		font-size: 150%;
		}	
h4		{
		font-size: 140%;
		background-color: #ccf;
		border-bottom: 1px solid #99f;
		width: 100%;
		}
h5		{
		margin: 1em 0em 0em 0em;
		font-size: 120%;
		}
h6		{
		margin: 0em 0em 0em 3em;
		font-style: italic;
		font: bold italic;
		font-size: 100%;
		}
#variables, #methods, #methoddetail
		{
		padding-left: 3em;
		margin-bottom: 1.4em;
		clear: both;
		float: none;
		}
#methods ul.method, #variables ul.method
		{
		margin: 1em 0em 0em;
		}
#methoddetail ul.method
		{
		margin: 0em;
		}
div.inexternal
		{
		padding-left: 2em;
		margin-bottom: 1em;
		}
div.methoddetail p
		{
		float: none;
		clear: both;
		padding-left: 2em;
		margin-bottom: 1em;
		}
div.methoddetail{
		padding-bottom: 1em;
		}
div.methoddetail li
		{
		list-style-type: none;
		font-weight: bold;
		}
div.methoddetail li li
		{
		list-style-type: circle;
		font-weight: normal;
		}
div.methoddetail li ul
		{
		padding-bottom: 0.5em;
		font-weight: normal;
		}
table.inexternal{
		clear: both;
		float: none;
		width: 80%;
		margin-left: 3em;
		padding: 0em;
		
		}
table.inexternal th
		{
		background-color:#dedede;
		width: 50%;
		}			
td		{
		vertical-align: top;
		}
div.description {
		margin-top: .5em;
		font-weight: normal;
		padding-left: 1em;
		}
ul.method	{
		clear: both;
		float: none;
		width: 90%;
		list-style-type: none;
		border-top: 1px solid #ccc;
		}
ul.method li.left
		{
		float: left;
		clear: none;
		width: 40%;
		font-weight: bold;
		margin-bottom: 2em;
		}
ul.method li.right
		{
		position: relative;
            top: 0em;
		float: left;
            width: 55%;
		margin-bottom: 2em;
		padding-left: 2em;
		}
div.home 	{
		width: 60%;
		float: left;
		margin-right: 1%;
		border: 1px
		}
div.home h4	{
		font-size: 120%;
		background-color: #fff;
		border-bottom: 1px solid #99f;
		width: 100%;
		margin-bottom: -1em;
		}
div.overview p {
               width: 60%;
               }
     
 --></style></head><body><h4>Module URI</h4><h1>http://www.marklogic.com/tutorial2/sidebar</h1><h4>Variables</h4><div id="variables"><div><a name="$CURR-URL"></a><ul class="method"><li class="left">$CURR-URL</li><li class="right"></li></ul><ul></ul></div><div><a name="$LIMIT"></a><ul class="method"><li class="left">$LIMIT</li><li class="right"></li></ul><ul></ul></div><div><a name="$DELIM"></a><ul class="method"><li class="left">$DELIM</li><li class="right"></li></ul><ul></ul></div></div>&nbsp;<h4>Imported Modules</h4><div id="imports"><div><ul class="method"><li class="left">http://marklogic.com/appservices/search</li><li class="right"></li></ul><ul></ul></div></div>&nbsp;<h4>Function Summary</h4><div id="methods"><a name="methods"></a><ul class="method"><li class="left"><a href="#create-chiclet">create-chiclet</a><div class="description"></div></li><li class="right">( $query-string as xs:string ,<br>&nbsp; $facet as xs:string ,<br>&nbsp; $constraint as xs:string)<br><br></li></ul><ul class="method"><li class="left"><a href="#create-chiclets">create-chiclets</a><div class="description"></div></li><li class="right">( $query-string as xs:string) as element(div)<br><br></li></ul><ul class="method"><li class="left"><a href="#create-facets">create-facets</a><div class="description"></div></li><li class="right">( $facets as element(search:facet)*) as element(div)*<br><br></li></ul></div>&nbsp;<h4>Function Detail</h4><div id="methoddetail"><div id="create-chiclet" class="methoddetail"><h5><a name="create-chiclet"></a>create-chiclet</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function sidebar:create-chiclet($query-string as xs:string, $facet as xs:string, $constraint as xs:string){<br/&gt;    &amp;lt;span class=&#34;chiclet&#34; constraint=&#34;{$facet}:{$constraint}&#34;&amp;gt;{$facet}: {$constraint}&amp;lt;/span&amp;gt;,&amp;lt;br/&amp;gt;<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $query-string as xs:string ,<br>&nbsp; $facet as xs:string ,<br>&nbsp; $constraint as xs:string)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>Internal Functions that invoke this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.marklogic.com/tutorial2/sidebar</td><td><a href="#create-chiclets">create-chiclets</a></td></tr></table></div></div>&nbsp;<div id="create-chiclets" class="methoddetail"><h5><a name="create-chiclets"></a>create-chiclets</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function sidebar:create-chiclets($query-string as xs:string)<br/&gt;as element(div){<br/&gt;    let $matches := <br/&gt;        let $temp := fn:tokenize($query-string,$DELIM)<br/&gt;        return <br/&gt;            if (fn:contains($temp[1],&#34;:&#34;)) <br/&gt;            then $temp<br/&gt;            else fn:subsequence($temp,2)<br/&gt;    return<br/&gt;        &amp;lt;div id=&#34;chiclet-box&#34;&amp;gt;<br/&gt;        {<br/&gt;            for $match in $matches<br/&gt;            let $split-match := fn:tokenize($match,&#34;:&#34;)<br/&gt;            return sidebar:create-chiclet($query-string, $split-match[1], $split-match[2])<br/&gt;        }<br/&gt;        &amp;lt;/div&amp;gt;<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $query-string as xs:string) as element(div)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="3">http://www.w3.org/2005/xpath-functions</td><td>contains</td></tr><tr><td>subsequence</td></tr><tr><td>tokenize</td></tr></table></div><div class="methoddetail"><h6>Internal Functions used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.marklogic.com/tutorial2/sidebar</td><td><a href="#create-chiclet">create-chiclet</a></td></tr></table></div></div>&nbsp;<div id="create-facets" class="methoddetail"><h5><a name="create-facets"></a>create-facets</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function sidebar:create-facets($facets as element(search:facet)*)<br/&gt;as element(div)*{<br/&gt;    for $facet in $facets<br/&gt;    let $facet-name := $facet/@name/data()<br/&gt;    let $count := 0<br/&gt;    return <br/&gt;        if (fn:count($facet/search:facet-value) &amp;lt; 2) <br/&gt;        then () <br/&gt;        else<br/&gt;            &amp;lt;div class=&#34;facet-box&#34;&amp;gt;<br/&gt;              &amp;lt;h3&amp;gt;{$facet-name}&amp;lt;/h3&amp;gt;<br/&gt;              &amp;lt;ul facet-name=&#34;{$facet-name}&#34;&amp;gt;<br/&gt;              {<br/&gt;                for $bucket in $facet/search:facet-value<br/&gt;                let $_ := xdmp:set($count, $count + 1)<br/&gt;                let $bucket-name := $bucket/@name/data()<br/&gt;                let $added-facet := fn:concat($facet-name,&amp;apos;:&#34;&amp;apos;,$bucket-name,&amp;apos;&#34;&amp;apos;)<br/&gt;                return  if ($count &amp;gt; $LIMIT) <br/&gt;                        then (<br/&gt;                              &amp;lt;li class=&#34;hidden&#34; bucket-name=&#34;{$bucket-name}&#34;&amp;gt; <br/&gt;                                &amp;lt;span class=&#34;constraint&#34; constraint=&#34;{$added-facet}&#34;&amp;gt;{$bucket/text()} &amp;lt;span class=&#34;count&#34;&amp;gt; ({$bucket/@count/data()})&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;<br/&gt;                              &amp;lt;/li&amp;gt;<br/&gt;                             )<br/&gt;                        else (<br/&gt;                              &amp;lt;li bucket-name=&#34;{$bucket-name}&#34;&amp;gt; <br/&gt;                                &amp;lt;span class=&#34;constraint&#34; constraint=&#34;{$added-facet}&#34;&amp;gt;{$bucket/text()} &amp;lt;span class=&#34;count&#34;&amp;gt; ({$bucket/@count/data()})&amp;lt;/span&amp;gt;&amp;lt;/span&amp;gt;<br/&gt;                              &amp;lt;/li&amp;gt;<br/&gt;                             )<br/&gt;              }<br/&gt;              &amp;lt;!-- Need to add a More... button --&amp;gt;<br/&gt;              &amp;lt;/ul&amp;gt;<br/&gt;              { if ($count &amp;gt; $LIMIT) then &amp;lt;span class=&#34;more-button&#34;&amp;gt;more...&amp;lt;/span&amp;gt; else () }<br/&gt;            &amp;lt;/div&amp;gt;<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $facets as element(search:facet)*) as element(div)*<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="3">http://www.w3.org/2005/xpath-functions</td><td>concat</td></tr><tr><td>count</td></tr><tr><td>data</td></tr></table></div></div>&nbsp;</div>&nbsp;<div align="left"><i>Created by xqDoc-Lite version 1.0 on Mon Aug 25 10:51:44 EDT 2014</i></div></body></html>