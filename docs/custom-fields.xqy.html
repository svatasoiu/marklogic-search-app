<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xml:space="preserve"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>xqDoc -- Module</title><script language="JavaScript"><!--
        function popUp(URL) {
                 day = new Date();
                 id = day.getTime();
                 eval("page = window.open(URL, 'xqdoccode', 'toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=600,height=400,left = 412,top = 334');")
                 page.focus();
        }
      --></script><script language="JavaScript"><!--
	    function litePopUp(str) {    
  		  OpenWindow=window.open('', 'xqdoccode', 'toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=600,height=400,left = 412,top = 334');
  		  OpenWindow.document.write('<html xmlspace="preserve">');
  		  OpenWindow.document.write('<head>');
  		  OpenWindow.document.write('<title>xqDoc - Code Sample</title>');
  		  OpenWindow.document.write('</head>');  		    		    		  
  		  OpenWindow.document.write('<body xml:space="preserve">');
  		  OpenWindow.document.write('<pre>');
 		  OpenWindow.document.write(str);
 		  OpenWindow.document.write('</pre>');
  		  OpenWindow.document.write('</body>');
  		  OpenWindow.document.write('</html>');
  		  OpenWindow.document.close();
  		  page.focus();
        }
      --></script><style><!--
body		{
		font: 80% Verdana;
		}
table		{
		font-size: 100%;
		}
h1, h2, h3, h4, h5, h6
		{
		clear: both;
		float: none;
		}
h1		{
		font-size: 100%;
		margin: 0em;
		}
h2		{
		font-size: 180%;
		margin-bottom: -1em;
		margin-top: .3em;
		}
h3		{
		font-size: 150%;
		}	
h4		{
		font-size: 140%;
		background-color: #ccf;
		border-bottom: 1px solid #99f;
		width: 100%;
		}
h5		{
		margin: 1em 0em 0em 0em;
		font-size: 120%;
		}
h6		{
		margin: 0em 0em 0em 3em;
		font-style: italic;
		font: bold italic;
		font-size: 100%;
		}
#variables, #methods, #methoddetail
		{
		padding-left: 3em;
		margin-bottom: 1.4em;
		clear: both;
		float: none;
		}
#methods ul.method, #variables ul.method
		{
		margin: 1em 0em 0em;
		}
#methoddetail ul.method
		{
		margin: 0em;
		}
div.inexternal
		{
		padding-left: 2em;
		margin-bottom: 1em;
		}
div.methoddetail p
		{
		float: none;
		clear: both;
		padding-left: 2em;
		margin-bottom: 1em;
		}
div.methoddetail{
		padding-bottom: 1em;
		}
div.methoddetail li
		{
		list-style-type: none;
		font-weight: bold;
		}
div.methoddetail li li
		{
		list-style-type: circle;
		font-weight: normal;
		}
div.methoddetail li ul
		{
		padding-bottom: 0.5em;
		font-weight: normal;
		}
table.inexternal{
		clear: both;
		float: none;
		width: 80%;
		margin-left: 3em;
		padding: 0em;
		
		}
table.inexternal th
		{
		background-color:#dedede;
		width: 50%;
		}			
td		{
		vertical-align: top;
		}
div.description {
		margin-top: .5em;
		font-weight: normal;
		padding-left: 1em;
		}
ul.method	{
		clear: both;
		float: none;
		width: 90%;
		list-style-type: none;
		border-top: 1px solid #ccc;
		}
ul.method li.left
		{
		float: left;
		clear: none;
		width: 40%;
		font-weight: bold;
		margin-bottom: 2em;
		}
ul.method li.right
		{
		position: relative;
            top: 0em;
		float: left;
            width: 55%;
		margin-bottom: 2em;
		padding-left: 2em;
		}
div.home 	{
		width: 60%;
		float: left;
		margin-right: 1%;
		border: 1px
		}
div.home h4	{
		font-size: 120%;
		background-color: #fff;
		border-bottom: 1px solid #99f;
		width: 100%;
		margin-bottom: -1em;
		}
div.overview p {
               width: 60%;
               }
     
 --></style></head><body><h4>Module URI</h4><h1>http://www.nejm.org/custom-field-query</h1><h4>Variables</h4><div id="variables"><div><a name="$CATEGORY-PATH"></a><ul class="method"><li class="left">$CATEGORY-PATH</li><li class="right"></li></ul><ul></ul></div><div><a name="$SPECIALTY-PATH"></a><ul class="method"><li class="left">$SPECIALTY-PATH</li><li class="right"></li></ul><ul></ul></div><div><a name="$TOPIC-PATH"></a><ul class="method"><li class="left">$TOPIC-PATH</li><li class="right"></li></ul><ul></ul></div><div><a name="$PERSP-TOPIC-PATH"></a><ul class="method"><li class="left">$PERSP-TOPIC-PATH</li><li class="right"></li></ul><ul></ul></div><div><a name="$COLLATION"></a><ul class="method"><li class="left">$COLLATION</li><li class="right"></li></ul><ul></ul></div><div><a name="$OPTIONS"></a><ul class="method"><li class="left">$OPTIONS</li><li class="right"></li></ul><ul></ul></div></div>&nbsp;<h4>Imported Modules</h4><div id="imports"><div><ul class="method"><li class="left">http://marklogic.com/appservices/search</li><li class="right"></li></ul><ul></ul></div><div><ul class="method"><li class="left">http://www.nejm.org/topics</li><li class="right"></li></ul><ul></ul></div><div><ul class="method"><li class="left">http://www.nejm.org/specialties</li><li class="right"></li></ul><ul></ul></div><div><ul class="method"><li class="left">http://www.nejm.org/perspectives</li><li class="right"></li></ul><ul></ul></div></div>&nbsp;<h4>Function Summary</h4><div id="methods"><a name="methods"></a><ul class="method"><li class="left"><a href="#audio-visual">audio-visual</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#authorSurname">authorSurname</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#category">category</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#finish">finish</a><div class="description"></div></li><li class="right">( $start as item()* ,<br>&nbsp; $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as element(search:facet)<br><br></li></ul><ul class="method"><li class="left"><a href="#finish-persp-topic-str">finish-persp-topic-str</a><div class="description"></div></li><li class="right">( $start as item()* ,<br>&nbsp; $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as element(search:facet)<br><br></li></ul><ul class="method"><li class="left"><a href="#finish-specialty">finish-specialty</a><div class="description"></div></li><li class="right">( $start as item()* ,<br>&nbsp; $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as element(search:facet)<br><br></li></ul><ul class="method"><li class="left"><a href="#finish-topic">finish-topic</a><div class="description"></div></li><li class="right">( $start as item()* ,<br>&nbsp; $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as element(search:facet)<br><br></li></ul><ul class="method"><li class="left"><a href="#has-audio">has-audio</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#has-video">has-video</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#images">images</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#manuscriptId">manuscriptId</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#persp-topic-str">persp-topic-str</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#specialty">specialty</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul class="method"><li class="left"><a href="#start">start</a><div class="description"></div></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong* ,<br>&nbsp; $path as xs:string) as item()*<br><br></li></ul><ul class="method"><li class="left"><a href="#start-category">start-category</a><div class="description"></div></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as item()*<br><br></li></ul><ul class="method"><li class="left"><a href="#start-persp-topic-str">start-persp-topic-str</a><div class="description"></div></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as item()*<br><br></li></ul><ul class="method"><li class="left"><a href="#start-specialty">start-specialty</a><div class="description"></div></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as item()*<br><br></li></ul><ul class="method"><li class="left"><a href="#start-topic">start-topic</a><div class="description"></div></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as item()*<br><br></li></ul><ul class="method"><li class="left"><a href="#topic">topic</a><div class="description"></div></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul></div>&nbsp;<h4>Function Detail</h4><div id="methoddetail"><div id="audio-visual" class="methoddetail"><h5><a name="audio-visual"></a>audio-visual</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:audio-visual (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;        let $word := fn:string($right//cts:text/text()) <br/&gt;        return<br/&gt;            if($qtext eq &#34;audio:&#34; or &#34;video:&#34;) then (<br/&gt;                cts:element-word-query((fn:QName(&#34;http://purl.org/dc/terms/&#34;,&#34;title&#34;),fn:QName(&#34;http://purl.org/dc/terms/&#34;,&#34;abstract&#34;)),<br/&gt;                                       $word,<br/&gt;                                       (&#34;case-insensitive&#34;, &#34;punctuation-insensitive&#34;))<br/&gt;            ) else ()         <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://marklogic.com/cts</td><td>element-word-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="2">http://www.w3.org/2005/xpath-functions</td><td>QName</td></tr><tr><td>string</td></tr></table></div></div>&nbsp;<div id="authorSurname" class="methoddetail"><h5><a name="authorSurname"></a>authorSurname</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:authorSurname (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;        let $author := fn:string($right//cts:text/text())<br/&gt;        return<br/&gt;            if ($qtext eq &#34;authorSurname:&#34;) then <br/&gt;               cts:element-query(xs:QName(&#34;didl:Descriptor&#34;), <br/&gt;                   cts:and-query((cts:element-attribute-value-query(xs:QName(&#34;didl:Descriptor&#34;),<br/&gt;                                                                    xs:QName(&#34;id&#34;),<br/&gt;                                                                    &#34;d400&#34;),<br/&gt;                                  cts:element-value-query ( xs:QName (&#34;surname&#34;), $author )<br/&gt;                   ))<br/&gt;               )<br/&gt;            else ()    <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="4">http://marklogic.com/cts</td><td>and-query</td></tr><tr><td>element-attribute-value-query</td></tr><tr><td>element-query</td></tr><tr><td>element-value-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="category" class="methoddetail"><h5><a name="category"></a>category</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:category (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;        let $category := fn:string($right//cts:text/text())<br/&gt;        return<br/&gt;            if ($qtext eq &#34;category:&#34;) then <br/&gt;               cts:element-query(xs:QName(&#34;didl:Descriptor&#34;), <br/&gt;                   cts:and-query((cts:element-attribute-value-query(xs:QName(&#34;didl:Descriptor&#34;),<br/&gt;                                                                    xs:QName(&#34;id&#34;),<br/&gt;                                                                    &#34;d400&#34;),<br/&gt;                                  cts:element-value-query ( xs:QName (&#34;subject&#34;), $category )<br/&gt;                   ))<br/&gt;               )<br/&gt;            else ()    <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="4">http://marklogic.com/cts</td><td>and-query</td></tr><tr><td>element-attribute-value-query</td></tr><tr><td>element-query</td></tr><tr><td>element-value-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="finish" class="methoddetail"><h5><a name="finish"></a>finish</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:finish (<br/&gt; $start as item()*,<br/&gt; $constraint as element(search:constraint), <br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?, <br/&gt; $forests as xs:unsignedLong*)<br/&gt;as element(search:facet){<br/&gt;   element search:facet {<br/&gt;     attribute name {$constraint/@name},<br/&gt;     for $range in $start <br/&gt;     return <br/&gt;        element search:facet-value { <br/&gt;            attribute name { $range/@name }, <br/&gt;            attribute count { $range/@count },<br/&gt;            fn:string($range/@name)<br/&gt;        }<br/&gt;   }<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $start as item()* ,<br>&nbsp; $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as element(search:facet)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="finish-persp-topic-str" class="methoddetail"><h5><a name="finish-persp-topic-str"></a>finish-persp-topic-str</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:finish-persp-topic-str (<br/&gt; $start as item()*,<br/&gt; $constraint as element(search:constraint), <br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?, <br/&gt; $forests as xs:unsignedLong*)<br/&gt;as element(search:facet){<br/&gt;   element search:facet {<br/&gt;     attribute name {$constraint/@name},<br/&gt;     for $range in $start <br/&gt;     return <br/&gt;        element search:facet-value { <br/&gt;            attribute name { $range/@topic }, <br/&gt;            attribute count { $range/@count }, <br/&gt;            fn:string($range/@topic) <br/&gt;        }<br/&gt;   }<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $start as item()* ,<br>&nbsp; $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as element(search:facet)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="finish-specialty" class="methoddetail"><h5><a name="finish-specialty"></a>finish-specialty</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:finish-specialty (<br/&gt; $start as item()*,<br/&gt; $constraint as element(search:constraint), <br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?, <br/&gt; $forests as xs:unsignedLong*)<br/&gt;as element(search:facet){<br/&gt;   element search:facet {<br/&gt;     attribute name {$constraint/@name},<br/&gt;     for $range in $start <br/&gt;     return <br/&gt;        element search:facet-value { <br/&gt;            attribute name { $range/@name }, <br/&gt;            attribute count { $range/@count }, <br/&gt;            fn:string($range/@name) <br/&gt;        }<br/&gt;   }<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $start as item()* ,<br>&nbsp; $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as element(search:facet)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="finish-topic" class="methoddetail"><h5><a name="finish-topic"></a>finish-topic</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:finish-topic (<br/&gt; $start as item()*,<br/&gt; $constraint as element(search:constraint), <br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?, <br/&gt; $forests as xs:unsignedLong*)<br/&gt;as element(search:facet){<br/&gt;    element search:facet {<br/&gt;     attribute name {$constraint/@name},<br/&gt;     for $range in $start <br/&gt;     return <br/&gt;        element search:facet-value{ <br/&gt;            attribute name { $range/@name }, <br/&gt;            attribute count { $range/@count }, <br/&gt;            fn:string($range/@name) <br/&gt;        }<br/&gt;     }<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $start as item()* ,<br>&nbsp; $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as element(search:facet)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="has-audio" class="methoddetail"><h5><a name="has-audio"></a>has-audio</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:has-audio (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;        let $has := fn:string($right//cts:text/text())<br/&gt;        return<br/&gt;            if ($qtext eq &#34;has_audio:&#34;) <br/&gt;            then if ($has eq &#34;true&#34;)<br/&gt;                 then cts:element-query(xs:QName(&#34;rdf:Description&#34;), <br/&gt;                                        cts:and-query((cts:element-value-query(xs:QName(&#34;dcterms:type&#34;),&#34;audio&#34;))))<br/&gt;                 else cts:not-query(cts:element-query(xs:QName(&#34;rdf:Description&#34;), <br/&gt;                                        cts:and-query((cts:element-value-query(xs:QName(&#34;dcterms:type&#34;),&#34;audio&#34;)))))<br/&gt;            else ()    <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="4">http://marklogic.com/cts</td><td>and-query</td></tr><tr><td>element-query</td></tr><tr><td>element-value-query</td></tr><tr><td>not-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="has-video" class="methoddetail"><h5><a name="has-video"></a>has-video</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:has-video (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;        let $has := fn:string($right//cts:text/text())<br/&gt;        return<br/&gt;            if ($qtext eq &#34;has_video:&#34;) <br/&gt;            then if ($has eq &#34;true&#34;)<br/&gt;                 then cts:element-query(xs:QName(&#34;rdf:Description&#34;), <br/&gt;                                        cts:or-query((cts:element-value-query(xs:QName(&#34;dcterms:type&#34;),&#34;video&#34;),<br/&gt;                                                      cts:element-value-query(xs:QName(&#34;dcterms:type&#34;),&#34;vcm-video&#34;))))<br/&gt;                 else cts:not-query(cts:element-query(xs:QName(&#34;rdf:Description&#34;), <br/&gt;                                        cts:or-query((cts:element-value-query(xs:QName(&#34;dcterms:type&#34;),&#34;video&#34;),<br/&gt;                                                      cts:element-value-query(xs:QName(&#34;dcterms:type&#34;),&#34;vcm-video&#34;)))))<br/&gt;            else ()    <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="4">http://marklogic.com/cts</td><td>element-query</td></tr><tr><td>element-value-query</td></tr><tr><td>not-query</td></tr><tr><td>or-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="images" class="methoddetail"><h5><a name="images"></a>images</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:images (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;        let $word := fn:string($right//cts:text/text()) <br/&gt;        return<br/&gt;            if($qtext eq &#34;images:&#34;) then (<br/&gt;                 cts:element-word-query((fn:QName(&#34;http://www.massmed.org/elements/&#34;,&#34;label&#34;),<br/&gt;                                         fn:QName(&#34;http://www.massmed.org/elements/&#34;,&#34;title&#34;),<br/&gt;                                         fn:QName(&#34;http://www.massmed.org/elements/&#34;,&#34;caption&#34;)),<br/&gt;                                        $word,<br/&gt;                                        (&#34;case-insensitive&#34;, &#34;punctuation-insensitive&#34;))<br/&gt;            ) else ()         <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://marklogic.com/cts</td><td>element-word-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="2">http://www.w3.org/2005/xpath-functions</td><td>QName</td></tr><tr><td>string</td></tr></table></div></div>&nbsp;<div id="manuscriptId" class="methoddetail"><h5><a name="manuscriptId"></a>manuscriptId</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:manuscriptId (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;<br/&gt;        let $manuscriptId := fn:string($right//cts:text/text())<br/&gt;        let $identifier := fn:concat(&#34;NEJMp&#34;, $manuscriptId)<br/&gt;        let $doi-list := /didl:DIDL[didl:Item/didl:Descriptor[@id=&amp;apos;d210&amp;apos;]/didl:Statement[fn:ends-with(dii:Identifier, $identifier)]]/@DIDLDocumentId<br/&gt;        return<br/&gt;            if($qtext eq &#34;manuscriptId:&#34;) then (<br/&gt;                cts:and-query((<br/&gt;                    cts:element-value-query(fn:QName(&#34;urn:mpeg:mpeg21:2002:01-DII-NS&#34;,&#34;Identifier&#34;), $doi-list)<br/&gt;                ))<br/&gt;            ) else ()<br/&gt;            <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="2">http://marklogic.com/cts</td><td>and-query</td></tr><tr><td>element-value-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="4">http://www.w3.org/2005/xpath-functions</td><td>QName</td></tr><tr><td>concat</td></tr><tr><td>ends-with</td></tr><tr><td>string</td></tr></table></div></div>&nbsp;<div id="persp-topic-str" class="methoddetail"><h5><a name="persp-topic-str"></a>persp-topic-str</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:persp-topic-str (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;<br/&gt;        let $top := fn:string($right//cts:text/text()) <br/&gt;        let $top-id  := perspectives:str-to-id($top)<br/&gt;        return<br/&gt;            if($qtext eq &#34;persp-topic-str:&#34;) then (<br/&gt;                 cts:path-range-query ($PERSP-TOPIC-PATH, &#34;=&#34;, $top-id, &#34;collation=http://marklogic.com/collation/&#34;)<br/&gt;            ) else ()         <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://marklogic.com/cts</td><td>path-range-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.nejm.org/perspectives</td><td>str-to-id</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="specialty" class="methoddetail"><h5><a name="specialty"></a>specialty</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:specialty (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;<br/&gt;        let $specialty := fn:string($right//cts:text/text()) <br/&gt;        let $spec-id  := specialties:str-to-id($specialty)<br/&gt;        return<br/&gt;            if($qtext eq &#34;specialty:&#34;) then (<br/&gt;                 cts:path-range-query ($SPECIALTY-PATH, &#34;=&#34;, $spec-id, &#34;collation=http://marklogic.com/collation/&#34;)<br/&gt;            ) else ()         <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://marklogic.com/cts</td><td>path-range-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.nejm.org/specialties</td><td>str-to-id</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;<div id="start" class="methoddetail"><h5><a name="start"></a>start</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:start (<br/&gt; $constraint as element(search:constraint),<br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?,<br/&gt; $forests as xs:unsignedLong*,<br/&gt; $path as xs:string) <br/&gt;as item()*{<br/&gt;    for $item in cts:values(cts:path-reference($path, ($COLLATION)),<br/&gt;                                 (),<br/&gt;                                 ($facet-options,&#34;concurrent&#34;),<br/&gt;                                 $query,<br/&gt;                                 $quality-weight,<br/&gt;                                 $forests)<br/&gt;    return &amp;lt;item-type name=&#34;{$item}&#34; count=&#34;{cts:frequency($item)}&#34;/&amp;gt;<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong* ,<br>&nbsp; $path as xs:string) as item()*<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="3">http://marklogic.com/cts</td><td>frequency</td></tr><tr><td>path-reference</td></tr><tr><td>values</td></tr></table></div></div>&nbsp;<div id="start-category" class="methoddetail"><h5><a name="start-category"></a>start-category</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:start-category (<br/&gt; $constraint as element(search:constraint),<br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?,<br/&gt; $forests as xs:unsignedLong*) <br/&gt;as item()*{<br/&gt;    start($constraint,$query, $facet-options, $quality-weight, $forests, $CATEGORY-PATH)<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as item()*<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>start</td></tr></table></div></div>&nbsp;<div id="start-persp-topic-str" class="methoddetail"><h5><a name="start-persp-topic-str"></a>start-persp-topic-str</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:start-persp-topic-str (<br/&gt; $constraint as element(search:constraint),<br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?,<br/&gt; $forests as xs:unsignedLong*) <br/&gt;as item()*{<br/&gt;    for $id in cts:values(cts:path-reference($PERSP-TOPIC-PATH, (&#34;collation=http://marklogic.com/collation/&#34;)),<br/&gt;                                 (),<br/&gt;                                 ($facet-options,&#34;concurrent&#34;),<br/&gt;                                 $query,<br/&gt;                                 $quality-weight,<br/&gt;                                 $forests)<br/&gt;    let $top-name :=  perspectives:id-to-str($id)<br/&gt;    order by $top-name<br/&gt;    return if ($top-name) then &amp;lt;perspective-type topic=&#34;{$top-name}&#34; count=&#34;{cts:frequency($id)}&#34;/&amp;gt; else ()<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as item()*<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="3">http://marklogic.com/cts</td><td>frequency</td></tr><tr><td>path-reference</td></tr><tr><td>values</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.nejm.org/perspectives</td><td>id-to-str</td></tr></table></div></div>&nbsp;<div id="start-specialty" class="methoddetail"><h5><a name="start-specialty"></a>start-specialty</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:start-specialty (<br/&gt; $constraint as element(search:constraint),<br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?,<br/&gt; $forests as xs:unsignedLong*) <br/&gt;as item()*{<br/&gt;    for $id in cts:values(cts:path-reference($SPECIALTY-PATH, (&#34;collation=http://marklogic.com/collation/&#34;)),<br/&gt;                                 (),<br/&gt;                                 ($facet-options,&#34;concurrent&#34;),<br/&gt;                                 $query,<br/&gt;                                 $quality-weight,<br/&gt;                                 $forests)<br/&gt;    let $spec-name := specialties:id-to-str($id)<br/&gt;    order by $spec-name<br/&gt;    return if ($spec-name) then &amp;lt;specialty-type name=&#34;{$spec-name}&#34; count=&#34;{cts:frequency($id)}&#34;/&amp;gt; else ()<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as item()*<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="3">http://marklogic.com/cts</td><td>frequency</td></tr><tr><td>path-reference</td></tr><tr><td>values</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.nejm.org/specialties</td><td>id-to-str</td></tr></table></div></div>&nbsp;<div id="start-topic" class="methoddetail"><h5><a name="start-topic"></a>start-topic</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:start-topic (<br/&gt; $constraint as element(search:constraint),<br/&gt; $query as cts:query?,<br/&gt; $facet-options as xs:string*,<br/&gt; $quality-weight as xs:double?,<br/&gt; $forests as xs:unsignedLong*) <br/&gt;as item()*{<br/&gt;    for $id in cts:values(cts:path-reference($TOPIC-PATH, ($COLLATION)),<br/&gt;                                 (),<br/&gt;                                 ($facet-options,&#34;concurrent&#34;),<br/&gt;                                 $query,<br/&gt;                                 $quality-weight,<br/&gt;                                 $forests)<br/&gt;    let $top-name := topics:id-to-str($id)<br/&gt;    order by $top-name<br/&gt;    return if ($top-name) then &amp;lt;topic-type name=&#34;{$top-name}&#34; count=&#34;{cts:frequency($id)}&#34;/&amp;gt; else ()<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $constraint as element(search:constraint) ,<br>&nbsp; $query as cts:query? ,<br>&nbsp; $facet-options as xs:string* ,<br>&nbsp; $quality-weight as xs:double? ,<br>&nbsp; $forests as xs:unsignedLong*) as item()*<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="3">http://marklogic.com/cts</td><td>frequency</td></tr><tr><td>path-reference</td></tr><tr><td>values</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.nejm.org/topics</td><td>id-to-str</td></tr></table></div></div>&nbsp;<div id="topic" class="methoddetail"><h5><a name="topic"></a>topic</h5><ul class="method"><li class="left"><a href="javascript:litePopUp('declare function custom-field-query:topic (<br/&gt;%09$qtext as xs:string,<br/&gt;%09$right as schema-element(cts:query)) <br/&gt;as schema-element(cts:query){<br/&gt;    &amp;lt;root&amp;gt;{<br/&gt;<br/&gt;        let $topic := fn:string($right//cts:text/text()) <br/&gt;        let $top-id  := topics:str-to-id($topic)<br/&gt;        return<br/&gt;            if($qtext eq &#34;topic:&#34;) then (<br/&gt;                 cts:path-range-query ($TOPIC-PATH, &#34;=&#34;, $top-id, $COLLATION)<br/&gt;            ) else ()         <br/&gt;%09}&amp;lt;/root&amp;gt;/*<br/&gt;};<br/&gt;')">
         view code
      </a></li><li class="right">( $qtext as xs:string ,<br>&nbsp; $right as schema-element(cts:query)) as schema-element(cts:query)<br><br></li></ul><ul></ul><div class="methoddetail"><h6>External Functions that are used by this Function</h6><table class="inexternal"><tr><th align="left">Module URI</th><th align="left">Function Name</th></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://marklogic.com/cts</td><td>path-range-query</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.nejm.org/topics</td><td>str-to-id</td></tr><tr><td>&nbsp;</td><td>&nbsp;</td></tr><tr><td rowspan="1">http://www.w3.org/2005/xpath-functions</td><td>string</td></tr></table></div></div>&nbsp;</div>&nbsp;<div align="left"><i>Created by xqDoc-Lite version 1.0 on Mon Aug 25 10:51:13 EDT 2014</i></div></body></html>